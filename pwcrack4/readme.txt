revise code and test pw iterately
